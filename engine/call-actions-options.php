<?php
/**
 * Twenty'em WordPress Framework.
 *
 * WARNING: This file is part of Twenty'em WordPress Framework.
 * DO NOT edit this file under any circumstances. Do all your modifications in the form of a child theme.
 *
 * @package			WordPress
 * @subpackage		Twenty'em
 * @author			RogerTM
 * @license			license.txt
 * @link			https://themingisprose.com/twenty-em
 * @since 			Twenty'em 1.4.0
 */

/**
 * Twenty'em Call to Actions theme options.
 */

/**
 * Array of Call to Actions options
 * @return array
 *
 * @since Twenty'em 1.4.0
 */
function t_em_call_actions_options(){
	$call_actions = array(
		'call_action_one'	=> array(
			'name'	=> 'call_action_one',
			'label'	=> __( 'First Call to Action', 't_em' ),
		),
		'call_action_two'	=> array(
			'name'	=> 'call_action_two',
			'label'	=> __( 'Second Call to Action', 't_em' ),
		),
		'call_action_three'	=> array(
			'name'	=> 'call_action_three',
			'label'	=> __( 'Third Call to Action', 't_em' ),
		),
		'call_action_four'	=> array(
			'name'	=> 'call_action_four',
			'label'	=> __( 'Fourth Call to Action', 't_em' ),
		),
	);

	/**
	 * Filter the Call to Actions Options Set
	 * @param array An array of new options.
	 * 				Keyed by a string id. The ids point to arrays containing 'name' and 'label' keys.
	 * @since Twenty'em 1.4.0
	 */
	return apply_filters( 't_em_admin_filter_call_actions_options', $call_actions );
}

/**
 * Array of tags where to hooks the Call to Actions
 * @return array
 *
 * @since Twenty'em 1.4.0
 */
function t_em_call_actions_tags(){
	$tags = array(
		't_em_action_top'						=> __( 'On top of all', 't_em' ),
		'wp_footer'								=> __( 'Down of all', 't_em' ),
		't_em_action_header_before'				=> __( 'Up to Header', 't_em' ),
		't_em_action_header_after'				=> __( 'Down to Header', 't_em' ),
		't_em_action_main_before'				=> __( 'Before main content', 't_em' ),
		't_em_action_main_after'				=> __( 'After main content', 't_em' ),
		't_em_action_content_before'			=> __( 'Up to main content', 't_em' ),
		't_em_action_content_after'				=> __( 'Down to main content', 't_em' ),
		't_em_action_custom_front_page_before'	=> __( 'Up to main content (If Custom Front Page is active)', 't_em' ),
		't_em_action_custom_front_page_after'	=> __( 'Down to main content (If Custom Front Page is active)', 't_em' ),
		't_em_action_footer_before'				=> __( 'Before footer', 't_em' ),
		't_em_action_footer_after'				=> __( 'After footer', 't_em' ),
		't_em_action_sidebar_before'			=> __( 'Before main sidebar', 't_em' ),
		't_em_action_sidebar_after'				=> __( 'After main sidebar', 't_em' ),
		't_em_action_sidebar_alt_before'		=> __( 'Before alternative sidebar', 't_em' ),
		't_em_action_sidebar_alt_after'			=> __( 'After alternative sidebar', 't_em' ),
	);

	/**
	 * Filter the Call to Actions tags
	 * @param array 	Array of 'tag' => 'label'
	 *
	 * @since Twenty'em 1.4.0
	 */
	return apply_filters( 't_em_admin_filter_call_actions_tags', $tags );
}

/**
 * Sanitize and validate dynamically the Call to Actions tags
 * This function is attached to the "t_em_admin_filter_theme_options_validate" filter hook
 *
 * @since Twenty'em 1.4.0
 */
function t_em_call_actions_tags_validate( $input ){
	if ( ! $input )
		return;

	foreach ( t_em_call_actions_options() as $action ) :
		foreach ( t_em_call_actions_tags() as $tag => $label ) :
			if ( array_key_exists( $input[$action['name'].'_hook_to'], t_em_call_actions_tags() ) )
				$input[$action['name'].'_hook_to'] = $input[$action['name'].'_hook_to'];
		endforeach;
	endforeach;
	return $input;
}
add_filter( 't_em_admin_filter_theme_options_validate', 't_em_call_actions_tags_validate' );

/**
 * Render the Call to Actions Options setting field in admin panel.
 * Referenced via t_em_register_setting_options_init(), add_settings_field() callback in
 * /engine/theme-options.php.
 *
 * @since Twenty'em 1.4.0
 */
function t_em_settings_field_call_actions_set(){
?>
	<div id="call-to-actions">
		<div class="row d-flex">
<?php
	$i = 0;
	foreach ( t_em_call_actions_options() as $action ) :
		if ( 0 == $i % 2 ) :
			echo '</div>';
			echo '<div class="row d-flex">';
		endif;
?>
			<div id="<?php echo $action['name'] ?>" class="sub-extend option-group flex-equal">
				<div class="layout text-option call-action">
					<header><?php echo $action['label'] ?></header>
					<p><label><span><?php _e( 'Headline', 't_em' ); ?></span>
						<input type="text" class="regular-text headline" name="t_em_theme_options[<?php echo $action['name']; ?>_headline]" value="<?php echo esc_textarea( t_em( $action['name'].'_headline' ) ) ?>">
					</label></p>
					<p><label><span><?php printf( __( 'Headline <a href="%1$s" target="_blank">Icon Class</a>', 't_em' ), T_EM_ICON_PACK ) ?></span>
						<input type="text" class="regular-text" name="t_em_theme_options[<?php echo $action['name']; ?>_headline_icon_class]" value="<?php echo t_em( $action['name'].'_headline_icon_class' ) ?>" />
					</label></p>
					<p><label><span><?php _e( 'Content', 't_em' ); ?></span>
						<textarea name="t_em_theme_options[<?php echo $action['name']; ?>_content]" class="large-text" cols="50" rows="10"><?php echo esc_textarea( t_em( $action['name'].'_content' ) ) ?></textarea>
					</label></p>
					<p><label><span><?php printf( __( '<a href="%1$s" target="_blank">Background Image</a>', 't_em' ), admin_url( 'upload.php' ) ) ?></span>
						<input type="url" id="t-em-call-action-image-url-<?php echo $action['name'] ?>" class="regular-text media-url" name="t_em_theme_options[<?php echo $action['name'] ?>_thumbnail_src]" value="<?php echo t_em( $action['name'].'_thumbnail_src' ) ?>" />
						<a href="#" id="t-em-button-call-action-image-<?php echo $action['name'] ?>" class="button media-selector"><?php _e( 'Upload Image', 't_em' ) ?></a>
					</label></p>
					<p><label><span><?php _e( 'Primary button text', 't_em' ); ?></span>
						<input type="text" class="regular-text" name="t_em_theme_options[<?php echo $action['name'] ?>_primary_button_text]" value="<?php echo t_em( $action['name'].'_primary_button_text' ) ?>" />
					</label></p>
					<p><label><span><?php printf( __( 'Primary button <a href="%1$s" target="_blank">Icon Class</a>', 't_em' ), T_EM_ICON_PACK ); ?></span>
						<input type="text" class="regular-text" name="t_em_theme_options[<?php echo $action['name'] ?>_primary_button_icon_class]" value="<?php echo t_em( $action['name'].'_primary_button_icon_class' ) ?>" />
					</label></p>
					<p><label><span><?php _e( 'Primary button link', 't_em' ); ?></span>
						<input type="url" class="regular-text" name="t_em_theme_options[<?php echo $action['name'] ?>_primary_button_link]" value="<?php echo t_em( $action['name'].'_primary_button_link' ) ?>" />
					</label></p>
					<p><label><span><?php _e( 'Secondary button text', 't_em' ); ?></span>
						<input type="text" class="regular-text" name="t_em_theme_options[<?php echo $action['name'] ?>_secondary_button_text]" value="<?php echo t_em( $action['name'].'_secondary_button_text' ) ?>" />
					</label></p>
					<p><label><span><?php printf( __( 'Secondary button <a href="%1$s" target="_blank">Icon Class</a>', 't_em' ), T_EM_ICON_PACK ); ?></span>
						<input type="text" class="regular-text" name="t_em_theme_options[<?php echo $action['name'] ?>_secondary_button_icon_class]" value="<?php echo t_em( $action['name'].'_secondary_button_icon_class' ) ?>" />
					</label></p>
					<p><label><span><?php _e( 'Secondary button link', 't_em' ); ?></span>
						<input type="url" class="regular-text" name="t_em_theme_options[<?php echo $action['name'] ?>_secondary_button_link]" value="<?php echo t_em( $action['name'].'_secondary_button_link' ) ?>" />
					</label></p>
					<p><label><span><?php _e( 'Hooked to', 't_em' ); ?></span>
						<select name="t_em_theme_options[<?php echo $action['name'] ?>_hook_to]">
							<option value=""><?php _e( '&mdash; Select &mdash;', 't_em' ) ?></option>
						<?php foreach ( t_em_call_actions_tags() as $tag => $label ) :
								$selected = selected( $tag, t_em( $action['name'].'_hook_to' ), false );
						?>
							<option value="<?php echo $tag ?>" <?php echo $selected ?>><?php echo $label ?></option>
						<?php endforeach; ?>
						</select>
					</label></p>
					<label class="description">
						<?php $checked_option = checked( t_em( $action['name'] .'_home_only' ), 1, false ) ?>
						<p><input type="checkbox" name="t_em_theme_options[<?php echo $action['name'] .'_home_only' ?>]" value="1" <?php echo $checked_option ?>>
						<?php _e( 'Show this Call to Action only in front page', 't_em' ) ?></p>
					</label>
				</div>
			</div>
<?php $i++; endforeach; ?>
		</div>
	</div>
<?php
}
?>
